import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';

/**
 * AuthenticatedGuard is a custom guard class that implements the `CanActivate` interface
 * provided by NestJS. It is used to determine if a user has the correct permissions to
 * proceed with the current request. This guard can be applied to routes to
 * protect them and ensure that only users with the right role can access them.
 *
 * The `canActivate` method extracts the request object from the execution context and
 * checks if the user has a valid role by calling `request.hasRole()`, which is
 * typically provided by a role-based access control strategy.
 *
 * This guard should be used in conjunction with role validation middleware that sets up
 * the `hasRole` method on the request object.
 *
 */
@Injectable()
export class AuthenticatedGuard implements CanActivate {
  async canActivate(context: ExecutionContext): Promise<boolean> {
    const request = context.switchToHttp().getRequest();
    return request.isAuthenticated();
  }
}
